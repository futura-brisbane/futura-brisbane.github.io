<!DOCTYPE html>
<html>
<head>
<title>Futura Map Demo!</title>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
<style>
#map {
height: 500px;
}
</style>
</head>
<body>

        <div id="map"></div>
<script>
var MAX_LOCATIONS = 1000;

var map = L.map('map', {
  center : [-27.45, 153],
  zoom : 11
});

// create the tile layer with correct attribution
var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
var osmAttrib='Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
var osm = new L.TileLayer(osmUrl, {minZoom: 8, maxZoom: 12, attribution: osmAttrib});
var MapQuestOpen_OSM = L.tileLayer('http://otile{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.jpeg', {
    attribution: 'Tiles Courtesy of <a href="http://www.mapquest.com/">MapQuest</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
    subdomains: '1234'
});
map.addLayer(MapQuestOpen_OSM);


$.ajax({
type: "GET",
url: "TheDataBase.csv",
    dataType: "text",
    success: function(data) {
     processData(data);
    }
})

var styles = {
    "Library": {
        radius: 1500,
        fillColor: '#ff0'
    },
    "Schools": {
        radius: 500,
        fillColor: '#03f'

    },
    "BusinessCentre": {
        radius: 500,
        fillColor: '#03f'

    },
    "BusStops": {
        radius: 500,
        fillColor: '#03f'

    },
    "Parks": {
        radius: 500,
        fillColor: '#03f'

    },
    "PetShops": {
        radius: 500,
        fillColor: '#03f'

    },
    "WifiHotSpot": {
        radius: 500,
        fillColor: '#03f'

    }
}


function processData(data) {
    result = $.csv.toObjects(data);
    drawCircles(result);
}

var markers = [];
function drawCircles(data) {
    $.each(markers, function(i, marker) {
        map.removeLayer(marker);
    });
    markers = [];

    $.each(data, function(i, val) {
        var circleType = val.Type;
        var radius = styles[circleType].radius;
        var style = {
            color: styles[circleType].fillColor,
            stroke: false,
            fillOpacity: 0.5
        }
        var marker = L.circle([val[' Latitude'], val['Longitude']], radius, style);

        marker.on('click', function() {
            console.log(circleType)
        })
        marker.addTo(map);
        markers.push(marker);
    });
}

</script>
</body>
</html>
